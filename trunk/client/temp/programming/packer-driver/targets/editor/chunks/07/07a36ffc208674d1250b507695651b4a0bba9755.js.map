{"version":3,"sources":["file:///F:/TON-Game/src/trunk/client/assets/scripts/tongame/invite/InviteMain.ts"],"names":["InviteItem","_decorator","Component","Label","oops","UIID","VirtualGridList","TableOtherParameter","StringUtil","IniviteMgr","UtilMgr","ProtocolMgr","ccclass","property","userid","InviteMain","_dataList","onAdded","params","TitleName","string","language","getLangByID","DesTxt","ShowTxt","AwardName1","AwardTxt1","tablerecord","init","AwardName2","AwardTxt2","substitute_1","parameter","LabelTxt1","LabelTxt2","InviteList","initGridList","completeOpenInvite","ret","console","log","res","isSucc","result","invitee","IniviteNum","length","sendOpenInvite","updategridList","gridList","refreshItemDisplays","i","item","push","clearList","paddingTop","paddingBottom","spacingX","spacingY","columnNum","useVirtualLayout","cacheImage","appendItemsToDisplayList","onOpenInviteActivity","PlaySoundEffect","gui","open","InviteAcivity","onOpenKongtouActivity","showstr","toast","onInviteBtnClick","share","onCopyBtnClick","copyLinkToClipboard","onCloseBtnClick","remove"],"mappings":"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","sourcesContent":["import { _decorator, Component, Node, Label } from 'cc';\r\nimport { oops } from '../../../../extensions/oops-plugin-framework/assets/core/Oops';\r\nimport { UIID } from '../../framework/common/config/GameUIConfig';\r\nimport { VirtualGridList } from \"../../../resources/libs/virtual_grid_list/virtual_grid_list\";\r\nimport { TableOtherParameter } from '../../framework/common/table/TableOtherParameter';\r\nimport { StringUtil } from '../../../../extensions/oops-plugin-framework/assets/core/utils/StringUtil';\r\nimport { IniviteMgr } from './InviteManager';\r\nimport { UtilMgr } from '../manager/UtilManager';\r\nimport { HttpReturn } from \"../../../../extensions/oops-plugin-framework/assets/libs/network/HttpRequest\";\r\nimport { ProtocolMgr } from \"../manager/ProtocolManager\";\r\n\r\nconst { ccclass, property } = _decorator;\r\n\r\nclass InviteItem {\r\n    userid : string = \"\";\r\n}\r\n\r\n@ccclass('InviteMain')\r\nexport class InviteMain extends Component {\r\n    @property(Label)\r\n    TitleName: Label;\r\n    @property(Label)\r\n    DesTxt: Label;\r\n    @property(Label)\r\n    ShowTxt: Label;\r\n    @property(Label)\r\n    AwardName1: Label;\r\n    @property(Label)\r\n    AwardTxt1: Label;\r\n    @property(Label)\r\n    AwardName2: Label;\r\n    @property(Label)\r\n    AwardTxt2: Label;\r\n\r\n    @property(Label)\r\n    LabelTxt1: Label;\r\n    @property(Label)\r\n    LabelTxt2: Label;\r\n\r\n    @property(VirtualGridList)\r\n    protected gridList: VirtualGridList = null;\r\n    private _dataList: any[] = [];\r\n\r\n    onAdded(params: any): boolean {\r\n        this.TitleName.string = oops.language.getLangByID(\"stringres_089\");\r\n        this.DesTxt.string = oops.language.getLangByID(\"stringres_183\");\r\n        this.ShowTxt.string = oops.language.getLangByID(\"stringres_090\") + \"\\n\"\r\n                                    + oops.language.getLangByID(\"stringres_091\") + \"\\n\"\r\n                                    + oops.language.getLangByID(\"stringres_092\");\r\n        this.AwardName1.string = oops.language.getLangByID(\"stringres_093\");\r\n        this.AwardTxt1.string = oops.language.getLangByID(\"stringres_094\");\r\n        let tablerecord = new TableOtherParameter();\r\n        tablerecord.init(4);\r\n        this.AwardName2.string = oops.language.getLangByID(\"stringres_095\");\r\n        this.AwardTxt2.string = StringUtil.substitute_1(oops.language.getLangByID(\"stringres_096\"), tablerecord.parameter);\r\n        this.LabelTxt1.string = oops.language.getLangByID(\"stringres_097\");\r\n        this.LabelTxt2.string = oops.language.getLangByID(\"stringres_098\");\r\n\r\n        if (IniviteMgr.InviteList)\r\n        {\r\n            this.initGridList();\r\n        }\r\n        else\r\n        {\r\n            var completeOpenInvite = (ret: HttpReturn) => {\r\n                console.log(ret.res);\r\n                if (ret.isSucc && ret.res.result)\r\n                {\r\n                    IniviteMgr.InviteList = ret.res.invitee;\r\n                    IniviteMgr.IniviteNum = IniviteMgr.InviteList.length;\r\n                    this.initGridList();\r\n                }\r\n            }\r\n            ProtocolMgr.sendOpenInvite(completeOpenInvite, \"\");\r\n        }\r\n        return true;\r\n    }\r\n\r\n    private updategridList() {\r\n        this.gridList.refreshItemDisplays();\r\n    }\r\n\r\n    initGridList() {\r\n        this._dataList = [];\r\n        for (let i=0; i<IniviteMgr.InviteList.length; i++) {\r\n            const item: InviteItem = {\r\n                userid: IniviteMgr.InviteList[i],\r\n            }\r\n            this._dataList.push(item);\r\n        }\r\n        /*  paddingTop: 列表距离上边缘距离 默认为0\r\n        paddingBottom: 列表距离下边缘距离 默认为0\r\n        spacingX: 列间距 默认为3\r\n        spacingY: 行间距 默认为3\r\n        columnNum: 列数 默认为0，自动适配容器宽度\r\n        useVirtualLayout: 是否启用虚拟列表 默认为true\r\n        emptyTip: 没有数据显示提示\r\n        cacheImage: 是否缓存列表中加载过的图片，控件回收后，图片缓存将被全部释放。\r\n     */\r\n        if (this.gridList) {\r\n            this.gridList.clearList();\r\n            this.gridList.initGridList({\r\n                paddingTop: 10,\r\n                paddingBottom: 10,\r\n                spacingX: 0,\r\n                spacingY: 0,\r\n                columnNum: 1,\r\n                useVirtualLayout: true,\r\n                // emptyTip: oops.language.getLangByID(\"stringres_088\"),\r\n                cacheImage: true\r\n            });\r\n\r\n            this.gridList.appendItemsToDisplayList(this._dataList);\r\n        }\r\n    }\r\n\r\n\r\n    public onOpenInviteActivity() {\r\n        UtilMgr.PlaySoundEffect(18);\r\n        oops.gui.open(UIID.InviteAcivity);\r\n    }\r\n\r\n    public onOpenKongtouActivity() {\r\n        UtilMgr.PlaySoundEffect(18);\r\n        let tablerecord = new TableOtherParameter();\r\n        tablerecord.init(4);\r\n        let showstr = StringUtil.substitute_1(oops.language.getLangByID(\"message_12\"), tablerecord.parameter);\r\n        oops.gui.toast(showstr, false);\r\n    }\r\n\r\n    // 点击邀请一个朋友按钮\r\n    public onInviteBtnClick() {\r\n        UtilMgr.PlaySoundEffect(18);\r\n        UtilMgr.share();\r\n    }\r\n    // 点击copy按钮\r\n    public onCopyBtnClick() {\r\n        UtilMgr.PlaySoundEffect(18);\r\n        oops.gui.toast(\"message_26\", true);\r\n        UtilMgr.copyLinkToClipboard();\r\n    }\r\n\r\n    public onCloseBtnClick() {\r\n        UtilMgr.PlaySoundEffect(19);\r\n        oops.gui.remove(UIID.InviteMain);\r\n    }\r\n}\r\n\r\n\r\n"]}