{"version":3,"sources":["file:///F:/TON-Game/src/trunk/client/assets/scripts/tongame/task/TaskListItem.ts"],"names":["_decorator","Label","Sprite","Button","IVirtualGridListItem","oops","UtilMgr","PaymentMgr","ProtocolMgr","TaskMgr","ccclass","property","TaskListItem","onDataChanged","data","SetImage","taskIcon","taskicon","taskName","string","language","getLangByID","tasktips","goBtnLabel","jiangliNum","carrotcoinnum","toString","isFinished","goBtn","node","active","doneImg","onClickGo","PlaySoundEffect","console","log","id","tasktype","joinChannel","dataParam","missionType","param","JSON","stringify","completeMission","ret","isSucc","res","result","modifyTaskData","sendUpdateMission","openBot","OpenPaymentUI","onDestroy"],"mappings":"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","sourcesContent":["import {_decorator, Label, Sprite, math, SpriteFrame, Node, Button} from 'cc';\r\nimport {IVirtualGridListItem} from \"../../../resources/libs/virtual_grid_list/interface\";\r\nimport { oops } from \"../../../../extensions/oops-plugin-framework/assets/core/Oops\";\r\nimport { UtilMgr } from \"../manager/UtilManager\";\r\nimport { PaymentMgr } from '../payment/PaymentManager';\r\nimport { ProtocolMgr } from \"../manager/ProtocolManager\";\r\nimport { TaskMgr } from \"../task/TaskManager\";\r\nimport { HttpReturn } from \"../../../../extensions/oops-plugin-framework/assets/libs/network/HttpRequest\";\r\n\r\n\r\nconst {ccclass, property} = _decorator;\r\n\r\n@ccclass('TaskListItem')\r\nexport class TaskListItem extends IVirtualGridListItem {\r\n\r\n    @property(Sprite)\r\n    taskIcon: Sprite = null;\r\n\r\n    @property(Label)\r\n    taskName: Label = null;\r\n\r\n    @property(Label)\r\n    jiangliNum: Label = null;\r\n\r\n    @property(Button)\r\n    goBtn: Button = null;\r\n\r\n    @property(Label)\r\n    goBtnLabel: Label = null;\r\n\r\n    @property(Sprite)\r\n    doneImg: Sprite = null;\r\n\r\n\r\n    onDataChanged() {\r\n        const data = this.data;\r\n        UtilMgr.SetImage(this.taskIcon, data.taskicon);\r\n        this.taskName.string = oops.language.getLangByID(data.tasktips);\r\n        this.goBtnLabel.string = oops.language.getLangByID(\"stringres_204\");\r\n\r\n        this.jiangliNum.string = data.carrotcoinnum.toString();\r\n\r\n        if (data.isFinished)\r\n        {\r\n            this.goBtn.node.active = false;\r\n            this.doneImg.node.active = true;\r\n        }\r\n        else\r\n        {\r\n            this.goBtn.node.active = true;\r\n            this.doneImg.node.active = false;\r\n        }\r\n    }\r\n\r\n    onClickGo() {\r\n        UtilMgr.PlaySoundEffect(18);\r\n        console.log(\"onClickGo id=\" + this.data.id);\r\n        if (this.data.tasktype == 1)\r\n        {//加入官方通知频道\r\n            UtilMgr.joinChannel();\r\n            const dataParam: { [key: string]: any } = {};\r\n            dataParam.missionType = this.data.tasktype;\r\n            const param = JSON.stringify(dataParam);\r\n            var completeMission = (ret: HttpReturn) => {\r\n                if (ret.isSucc && ret.res.result)\r\n                {\r\n                    this.goBtn.node.active = false;\r\n                    this.doneImg.node.active = true;\r\n                    TaskMgr.modifyTaskData(this.data.id, true);\r\n                }\r\n            }\r\n            ProtocolMgr.sendUpdateMission(completeMission, param);\r\n        }\r\n        else if (this.data.tasktype == 2)\r\n        {//使用官方bot\r\n            UtilMgr.openBot();\r\n            const dataParam: { [key: string]: any } = {};\r\n            dataParam.missionType = this.data.tasktype;\r\n            const param = JSON.stringify(dataParam);\r\n            var completeMission = (ret: HttpReturn) => {\r\n                if (ret.isSucc && ret.res.result)\r\n                {\r\n                    this.goBtn.node.active = false;\r\n                    this.doneImg.node.active = true;\r\n                    TaskMgr.modifyTaskData(this.data.id, true);\r\n                }\r\n            }\r\n            ProtocolMgr.sendUpdateMission(completeMission, param);\r\n        }\r\n        else if (this.data.tasktype == 3)\r\n        {//浏览官方频道\r\n            UtilMgr.joinChannel();\r\n            const dataParam: { [key: string]: any } = {};\r\n            dataParam.missionType = this.data.tasktype;\r\n            const param = JSON.stringify(dataParam);\r\n            var completeMission = (ret: HttpReturn) => {\r\n                if (ret.isSucc && ret.res.result)\r\n                {\r\n                    this.goBtn.node.active = false;\r\n                    this.doneImg.node.active = true;\r\n                    TaskMgr.modifyTaskData(this.data.id, true);\r\n                }\r\n            }\r\n            ProtocolMgr.sendUpdateMission(completeMission, param);\r\n        }\r\n        else if (this.data.tasktype == 4)\r\n        {//日常签到\r\n    \r\n        }\r\n        else if (this.data.tasktype == 5)\r\n        {//日常充值\r\n            PaymentMgr.OpenPaymentUI();\r\n        }\r\n    }\r\n\r\n    onDestroy() {\r\n        super.onDestroy();\r\n    }\r\n}\r\n"]}