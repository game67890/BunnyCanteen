{"version":3,"sources":["file:///F:/TON-Game/src/trunk/client/assets/scripts/tongame/hecheng/HeChengComponent.ts"],"names":["Animation","_decorator","Component","Node","Label","Prefab","instantiate","Vec3","tween","Button","UITransform","Sprite","oops","UIID","GameEvent","TonGameMgr","AutoTypeEnum","HeChengMgr","UtilMgr","BoardMgr","GAME_GRID_SIZE","GridComponent","FlyComponent","DiningTableMgr","TableShop","PaymentMgr","RankMgr","TaskMgr","RoleComponent","AcceleratedBuffMgr","FeedMgr","IniviteMgr","TableRestaurantlevel","TableIngredients","TableOtherParameter","ccclass","property","startX","startY","gridSpacing","tableStartX","tableStartY","tableSpacing","HeChengComponent","board","gridWidth","gridHeight","tableWidth","tableHeight","_tsRestaurantlevel","_tsIngredients","tableOtherParameter","tableShop","tuziCoinCount","start","update","deltaTime","onAdded","params","onAudioCompleteCallback","init","addEvent","createGrid","createTable","LixianShouyi","gui","open","ShouYiUI","preLoadPrefab","preLoad","Task","Rank","PaymentUI","CarrotMain","CarrotRank","ShopMain","AcceleratedBuffBuyMain","FeedMain","InviteMain","InviteAcivity","updateBaseData","updateTuziCoin","updateRankData","RefreshRabbitIcon","RefreshBuffIcon","RefreshFeedRed","RefreshMuteBtn","RefreshAutoBtn","onDestroy","StopBgMusic","removeEvent","message","on","UpdateBaseData","onUpdateData","UpdateTuziCoin","UpdateBoardGrid","OnAutoHecheng","UpdateAutoBtn","UpdateHuishouBtn","off","event","args","updateGrid","onAutoHecheng","RefreshHuishouBtn","PayLabel","string","language","getLangByID","TaskLabel","MakeLabel","FoodMarketLabel","InviteLabel","BuyLabel","BaluoboLabel","CanTingLevel","toString","CanTingGain","GetRealCanTingGain","SetImage","CanTingLevelBack","picture","NeedCoin","GetMakeSucaiCost","MakeNeedTuziCoin","formatNumber","BigInt","IngredientsId","GetSucaiIdByCanTingLv","MakeSucaiImage","TuZiCoin","RankData","GetRankDataByLevel","rankConfId","rankIcon","smallrankicon","tuZiCoinRankIds","rankNum","CurRabbitId","addNodeAnimation","parameter","RabbitIcon","node","CurRabbitAnimation","buffRedIcon","active","IsGetFreeBuff","animCtrl","buffIcon","getComponent","isAccelerating","defaultClip","getState","name","isPlaying","stop","FeedRedIcon","FreeDishId","IsMute","MuteBtnIcon","AutoType","NoBuy","autoBtnDefault","autoBtnEffect","HasBuyAndOpen","autoEffect","HasBuyButClose","IsDraging","normalBottom","huishouBottom","huishouText","onHuiShou","PlaySoundEffect","onRank","OpenRankUI","onChongZhi","OpenPaymentUI","onTask","OpenTaskUI","onCaiGou","onAuto","onPullCarrots","onGotoCarrots","onShopOpen","onOpenAccelerate","onOpenFeedMain","onOpenInviteMain","onMuteBtnClick","audio","switchEffect","switchMusic","PlayBgMusic","gridUITransform","gridPrefab","data","width","height","row","col","grid","parent","gridParentNode","setPosition","gridComponent","setVisible","push","getGridNode","index","length","cell","SuCaiId","setLiwuVisible","setLevel","GetSuCaiLevel","IsLiWu","IsLiWuFlying","SrcIndex","DestIndex","srcCell","gridFlyComponent","getComponentInChildren","console","log","InDragIndex","srcCol","Math","floor","destCol","srcRow","destRow","TargetX","TargetY","beginFly","createRole","role","rolePrefab","roleParentNode","halfRoleHeight","roleComponent","Init","tableUITransform","tablePrefab","table","tableParentNode","AddTable","createLiwu","liwu","liwuPrefab","liwuParentNode","createTuziCoin","RoleNode","i","coin","tuziCoinPrefab","tuziCoinParentNode","getPosition","offset","random","randomStartPosition","add","to","position","getPositionInParent","easing","call","destroy","setTimeout","CoinNode","TuziCoinPos","TuZiCoinImage","worldPos","convertToWorldSpaceAR","convertToNodeSpaceAR","ShowCanTingGainNum","originalScale","TempScale","scaleUp","multiplyScalar","scale","createGuide","guide","guidePrefab","ShowSucaiSelect","isShow","curIndex","setSelectVisible"],"mappings":"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","sourcesContent":["import { Animation, AnimationClip, _decorator, Component, Node, Label, Prefab, instantiate, Vec3, Vec2, view, ResolutionPolicy, tween} from 'cc';\r\nimport { oops } from \"../../../../extensions/oops-plugin-framework/assets/core/Oops\";\r\nimport { UIID } from \"../../framework/common/config/GameUIConfig\";\r\nimport { GameEvent } from \"../../framework/common/config/GameEvent\";\r\nimport { TonGameMgr, AutoTypeEnum } from \"../manager/TonGameManager\";\r\nimport { HeChengMgr } from \"./HeChengManager\";\r\nimport { UtilMgr } from \"../manager/UtilManager\";\r\nimport { BoardMgr, GAME_GRID_SIZE } from \"../manager/BoardManager\";\r\nimport { GridComponent } from \"./GridComponent\";\r\nimport { FlyComponent } from \"../contact/FlyComponent\";\r\nimport { DiningTableMgr } from \"../diningtable/DiningTableManager\";\r\n\r\nimport { Button } from 'cc';\r\nimport { UITransform } from 'cc';\r\nimport { Sprite } from 'cc';\r\nimport { TableShop } from '../../framework/common/table/TableShop';\r\n\r\nimport { PaymentMgr } from \"../payment/PaymentManager\";\r\nimport { RankMgr } from \"../rank/RankManager\";\r\nimport { TaskMgr } from \"../task/TaskManager\";\r\nimport { RoleComponent } from \"../role/RoleComponent\";\r\n\r\nimport { AcceleratedBuffMgr } from '../acceleratedbuff/AcceleratedBuffManager';\r\nimport { FeedMgr } from '../feed/FeedManager';\r\nimport { IniviteMgr } from '../invite/InviteManager';\r\nimport { TableRestaurantlevel } from \"../../framework/common/table/TableRestaurantlevel\";\r\nimport { TableIngredients } from \"../../framework/common/table/TableIngredients\";\r\nimport { TableOtherParameter } from '../../framework/common/table/TableOtherParameter';\r\n\r\nconst { ccclass, property } = _decorator;\r\n\r\nconst startX = -224;\r\nconst startY = 152; \r\nconst gridSpacing = 0; // 格子间距\r\n\r\nconst tableStartX = -160;\r\nconst tableStartY = 185; \r\nconst tableSpacing = 0; // 格子间距\r\n\r\n\r\n@ccclass('HeChengComponent')\r\nexport class HeChengComponent extends Component {\r\n    \r\n    /** 充值 */\r\n    @property(Label)\r\n    PayLabel: Label;\r\n\r\n    /** 任务 */\r\n    @property(Label)\r\n    TaskLabel: Label;\r\n\r\n    /** 制作 */\r\n    @property(Label)\r\n    MakeLabel: Label;\r\n\r\n    /** 制作需要消耗的兔子币 */\r\n    @property(Label)\r\n    MakeNeedTuziCoin: Label;\r\n\r\n    /** 制作生成的素材等级 */\r\n    @property(Sprite)\r\n    MakeSucaiImage: Sprite;\r\n\r\n    /** 菜场 */\r\n    @property(Label)\r\n    FoodMarketLabel: Label;\r\n\r\n    /** 邀请 */\r\n    @property(Label)\r\n    InviteLabel: Label;\r\n\r\n    /** 购买 */\r\n    @property(Label)\r\n    BuyLabel: Label;\r\n\r\n    /** 拔萝卜 */\r\n    @property(Label)\r\n    BaluoboLabel: Label;\r\n\r\n    /** 餐厅等级背景图片 */\r\n    @property(Sprite)\r\n    CanTingLevelBack: Sprite;\r\n\r\n    /** 餐厅等级 */\r\n    @property(Label)\r\n    CanTingLevel: Label;\r\n\r\n    /** 兔子币 */\r\n    @property(Label)\r\n    TuZiCoin: Label;\r\n\r\n    /** 兔子币图标 */\r\n    @property(Sprite)\r\n    TuZiCoinImage: Sprite;\r\n\r\n    /** 餐厅收益 */\r\n    @property(Label)\r\n    CanTingGain: Label;\r\n\r\n    /** 棋盘格子的预制体 */\r\n    @property(Prefab)\r\n    gridPrefab: Prefab = null; \r\n\r\n    /** 棋盘的父窗口 */\r\n    @property(Node)\r\n    gridParentNode: Node = null;\r\n\r\n    /** 引导的预制体 */\r\n    @property(Prefab)\r\n    guidePrefab: Prefab = null; \r\n\r\n    /** 桌子的预制体 */\r\n    @property(Prefab)\r\n    tablePrefab: Prefab = null; \r\n    \r\n    /** 桌子的父窗口 */\r\n    @property(Node)\r\n    tableParentNode: Node = null; \r\n\r\n    /** 角色的预制体 */\r\n    @property(Prefab)\r\n    rolePrefab: Prefab = null;\r\n\r\n    /** 角色的父窗口 */\r\n    @property(Node)\r\n    roleParentNode: Node = null;\r\n\r\n    /** 礼物的预制体 */\r\n    @property(Prefab)\r\n    liwuPrefab: Prefab = null;\r\n    \r\n    /** 礼物的父窗口 */\r\n    @property(Node)\r\n    liwuParentNode: Node = null; \r\n\r\n    /** 兔子币的预制体 */\r\n    @property(Prefab)\r\n    tuziCoinPrefab: Prefab = null;\r\n        \r\n    /** 礼物的父窗口 */\r\n    @property(Node)\r\n    tuziCoinParentNode: Node = null; \r\n\r\n    /** 拔萝卜按钮 */\r\n    @property(Button)\r\n    PullCarrotsBtn: Button;\r\n\r\n    /** 兔子icon */\r\n    @property(Sprite)\r\n    RabbitIcon : Sprite;\r\n    /** 加速icon */\r\n    @property(Sprite)\r\n    buffIcon : Sprite;\r\n    /** 加速红点icon */\r\n    @property(Sprite)\r\n    buffRedIcon : Sprite;\r\n    /** 喂食按钮红点icon */\r\n    @property(Sprite)\r\n    FeedRedIcon : Sprite;\r\n    /** 静音按钮icon */\r\n    @property(Sprite)\r\n    MuteBtnIcon : Sprite;\r\n\r\n    /** 排行榜段位图标 */\r\n    @property(Sprite)\r\n    rankIcon : Sprite;\r\n    /** 排行榜排名 */\r\n    @property(Label)\r\n    rankNum: Label;\r\n\r\n    /** 自动按钮(静态按钮不带动画)*/\r\n    @property(Node)\r\n    autoBtnDefault: Node;\r\n\r\n    /** 自动按钮(带动画) */\r\n    @property(Node)\r\n    autoBtnEffect: Node;\r\n    /** 自动按钮(播放动画的控件) */\r\n    @property(Node)\r\n    autoEffect: Node;\r\n\r\n    /** 正常的底框 */\r\n    @property(Node)\r\n    normalBottom: Node;\r\n\r\n    /** 回收的底框 */\r\n    @property(Node)\r\n    huishouBottom: Node;\r\n\r\n    /** 回收的文字 */\r\n    @property(Label)\r\n    huishouText: Label;\r\n\r\n    private board: Node[] = [];\r\n\r\n    private gridWidth = 150; // 格子宽\r\n    private gridHeight = 100; // 格子高\r\n\r\n    private tableWidth = 200; // 桌子宽\r\n    private tableHeight = 150; // 桌子高\r\n\r\n    private _tsRestaurantlevel = new TableRestaurantlevel();\r\n    private _tsIngredients = new TableIngredients();\r\n    private tableOtherParameter = new TableOtherParameter();\r\n    private tableShop = new TableShop();\r\n\r\n    private tuziCoinCount : number = 10;\r\n\r\n    start() {\r\n    }\r\n\r\n    update(deltaTime: number) {\r\n        \r\n    }\r\n\r\n    onAdded(params: any): boolean {\r\n        UtilMgr.onAudioCompleteCallback();\r\n        this.init();\r\n        this.addEvent();\r\n        this.createGrid();\r\n        this.createTable();\r\n\r\n        if (params.LixianShouyi > 0)\r\n        {\r\n            // 打开收益主界面\r\n            oops.gui.open(UIID.ShouYiUI, params);\r\n        }\r\n        //this.preLoadPrefab();\r\n        return true;\r\n    }\r\n    private preLoadPrefab()\r\n    {\r\n        oops.gui.preLoad(UIID.Task);\r\n        oops.gui.preLoad(UIID.Rank);\r\n        oops.gui.preLoad(UIID.PaymentUI);\r\n        oops.gui.preLoad(UIID.CarrotMain);\r\n        oops.gui.preLoad(UIID.CarrotRank);\r\n        oops.gui.preLoad(UIID.ShopMain);\r\n        oops.gui.preLoad(UIID.AcceleratedBuffBuyMain);\r\n        oops.gui.preLoad(UIID.FeedMain);\r\n        oops.gui.preLoad(UIID.InviteMain);\r\n        oops.gui.preLoad(UIID.InviteAcivity);\r\n    }\r\n\r\n    private init() {\r\n        this.updateBaseData();\r\n        this.updateTuziCoin();\r\n        this.updateRankData();\r\n        this.RefreshRabbitIcon();\r\n        this.RefreshBuffIcon();\r\n        this.RefreshFeedRed();\r\n        this.RefreshMuteBtn();\r\n        this.RefreshAutoBtn();\r\n    }\r\n\r\n    onDestroy() {\r\n        UtilMgr.StopBgMusic();\r\n        this.removeEvent();\r\n    }\r\n\r\n    /** 添加全局消息事件 */\r\n    private addEvent() {\r\n        oops.message.on(GameEvent.UpdateBaseData, this.onUpdateData, this);\r\n        oops.message.on(GameEvent.UpdateTuziCoin, this.onUpdateData, this);\r\n        oops.message.on(GameEvent.UpdateBoardGrid, this.onUpdateData, this);\r\n        oops.message.on(GameEvent.OnAutoHecheng, this.onUpdateData, this);\r\n        oops.message.on(GameEvent.UpdateAutoBtn, this.onUpdateData, this);\r\n        oops.message.on(GameEvent.UpdateHuishouBtn, this.onUpdateData, this);\r\n    }\r\n\r\n    /** 移除全局消息事件 */\r\n    private removeEvent() {\r\n        oops.message.off(GameEvent.UpdateBaseData, this.onUpdateData, this);\r\n        oops.message.off(GameEvent.UpdateTuziCoin, this.onUpdateData, this);\r\n        oops.message.off(GameEvent.UpdateBoardGrid, this.onUpdateData, this);\r\n        oops.message.off(GameEvent.OnAutoHecheng, this.onUpdateData, this);\r\n        oops.message.off(GameEvent.UpdateAutoBtn, this.onUpdateData, this);\r\n        oops.message.off(GameEvent.UpdateHuishouBtn, this.onUpdateData, this);\r\n    }\r\n\r\n    private onUpdateData(event: string, args: any) {\r\n        switch (event) {\r\n            case GameEvent.UpdateBaseData:\r\n                this.updateBaseData();\r\n                break;\r\n            case GameEvent.UpdateTuziCoin:\r\n                this.updateTuziCoin();\r\n                break;\r\n            case GameEvent.UpdateBoardGrid:\r\n                this.updateGrid();\r\n                break;\r\n            case GameEvent.OnAutoHecheng:\r\n                this.onAutoHecheng(args);\r\n                break;\r\n            case GameEvent.UpdateAutoBtn:\r\n                this.RefreshAutoBtn();\r\n                break;\r\n            case GameEvent.UpdateHuishouBtn:\r\n                this.RefreshHuishouBtn();\r\n                break;\r\n        }\r\n    }\r\n\r\n    private updateBaseData() {\r\n        this.PayLabel.string = oops.language.getLangByID(\"stringres_105\");\r\n        this.TaskLabel.string = oops.language.getLangByID(\"stringres_106\");\r\n        this.MakeLabel.string = oops.language.getLangByID(\"stringres_001\");\r\n        this.FoodMarketLabel.string = oops.language.getLangByID(\"stringres_107\");\r\n        this.InviteLabel.string = oops.language.getLangByID(\"stringres_108\");\r\n        //this.AutoLabel.string = oops.language.getLangByID(\"stringres_020\");\r\n        this.BuyLabel.string = oops.language.getLangByID(\"stringres_109\");\r\n        this.BaluoboLabel.string = oops.language.getLangByID(\"stringres_110\");\r\n        \r\n        this.CanTingLevel.string = TonGameMgr.CanTingLevel.toString();\r\n        this.CanTingGain.string = TonGameMgr.GetRealCanTingGain().toString() + \"/s\";\r\n\r\n        this._tsRestaurantlevel.init(TonGameMgr.CanTingLevel);\r\n        UtilMgr.SetImage(this.CanTingLevelBack, this._tsRestaurantlevel.picture);\r\n\r\n        let NeedCoin = HeChengMgr.GetMakeSucaiCost();\r\n        this.MakeNeedTuziCoin.string = UtilMgr.formatNumber(BigInt(NeedCoin));\r\n        let IngredientsId = HeChengMgr.GetSucaiIdByCanTingLv(TonGameMgr.CanTingLevel);\r\n        if (IngredientsId > 0)\r\n        {\r\n            this._tsIngredients.init(IngredientsId);\r\n            UtilMgr.SetImage(this.MakeSucaiImage, this._tsIngredients.picture);\r\n        }\r\n    }\r\n\r\n    private updateTuziCoin() {\r\n        this.TuZiCoin.string = UtilMgr.formatNumber(TonGameMgr.TuZiCoin);\r\n    }\r\n\r\n    private updateRankData() {\r\n        let RankData = RankMgr.GetRankDataByLevel(TonGameMgr.rankConfId);\r\n        if (RankData)\r\n        {\r\n            UtilMgr.SetImage(this.rankIcon, RankData.smallrankicon);\r\n            if (TonGameMgr.tuZiCoinRankIds > 0)\r\n            {\r\n                if (TonGameMgr.tuZiCoinRankIds == 1)\r\n                {\r\n                    this.rankNum.string = \"1st\";\r\n                }\r\n                else if (TonGameMgr.tuZiCoinRankIds == 2)\r\n                {\r\n                    this.rankNum.string = \"2nd\";\r\n                }\r\n                else if (TonGameMgr.tuZiCoinRankIds == 3)\r\n                {\r\n                    this.rankNum.string = \"3rd\";\r\n                }\r\n                else\r\n                {\r\n                    this.rankNum.string = TonGameMgr.tuZiCoinRankIds + \"th\";\r\n                }\r\n            }\r\n            else\r\n            {\r\n                this.rankNum.string = oops.language.getLangByID(\"stringres_206\");\r\n            }\r\n        }\r\n    }\r\n\r\n    public RefreshRabbitIcon() {\r\n        if (TonGameMgr.CurRabbitId <= 0) {\r\n            this.tableOtherParameter.init(8);\r\n            UtilMgr.addNodeAnimation(this.tableOtherParameter.parameter, this.RabbitIcon.node);\r\n        }\r\n        else {\r\n            this.tableShop.init(TonGameMgr.CurRabbitId);\r\n            // 兔子造型图标\r\n            UtilMgr.addNodeAnimation(TonGameMgr.CurRabbitAnimation, this.RabbitIcon.node);\r\n        }\r\n    }\r\n\r\n    public RefreshBuffIcon() {\r\n        this.buffRedIcon.node.active = (!AcceleratedBuffMgr.IsGetFreeBuff);\r\n        let animCtrl = this.buffIcon.getComponent(Animation);\r\n        if (AcceleratedBuffMgr.isAccelerating()) {\r\n            this.buffIcon.node.active = true;\r\n            if (!animCtrl || !animCtrl.defaultClip || !animCtrl.getState(animCtrl.defaultClip.name) || !animCtrl.getState(animCtrl.defaultClip.name).isPlaying) {\r\n                UtilMgr.addNodeAnimation(\"animation/jiasu\", this.buffIcon.node, true, true);\r\n            }\r\n        }\r\n        else {\r\n            this.buffIcon.node.active = false;\r\n            if (animCtrl) {\r\n                animCtrl.stop();\r\n            }\r\n        }\r\n    }\r\n\r\n    public RefreshFeedRed() {\r\n        this.FeedRedIcon.node.active = (FeedMgr.FreeDishId > 0);\r\n    }\r\n\r\n    public RefreshMuteBtn() {\r\n        if (!TonGameMgr.IsMute) {\r\n            this.tableOtherParameter.init(10);\r\n            \r\n        } else {\r\n            this.tableOtherParameter.init(11);\r\n        }\r\n        UtilMgr.SetImage(this.MuteBtnIcon, this.tableOtherParameter.parameter)\r\n    }\r\n\r\n    public RefreshAutoBtn()\r\n    {\r\n        if (TonGameMgr.AutoType == AutoTypeEnum.NoBuy)\r\n        {\r\n            this.autoBtnDefault.active = true;\r\n            this.autoBtnEffect.active = false;\r\n        }\r\n        else if (TonGameMgr.AutoType == AutoTypeEnum.HasBuyAndOpen)\r\n        {\r\n            this.autoBtnDefault.active = false;\r\n            this.autoBtnEffect.active = true;\r\n            UtilMgr.addNodeAnimation(\"animation/zidong\", this.autoEffect);\r\n        }\r\n        else if (TonGameMgr.AutoType == AutoTypeEnum.HasBuyButClose)\r\n        {\r\n            this.autoBtnDefault.active = true;\r\n            this.autoBtnEffect.active = false;\r\n        }\r\n    }\r\n\r\n    public RefreshHuishouBtn()\r\n    {\r\n        if (HeChengMgr.IsDraging)\r\n        {\r\n            this.normalBottom.active = false;\r\n            this.huishouBottom.active = true;\r\n            this.huishouText.string = oops.language.getLangByID(\"stringres_203\");\r\n        }\r\n        else\r\n        {\r\n            this.normalBottom.active = true;\r\n            this.huishouBottom.active = false;\r\n        }\r\n    }\r\n\r\n    /** 回收 */\r\n    private onHuiShou() {\r\n        UtilMgr.PlaySoundEffect(18);\r\n        HeChengMgr.onHuiShou();\r\n    }\r\n    //排行榜\r\n    private onRank() {\r\n        UtilMgr.PlaySoundEffect(18);\r\n        RankMgr.OpenRankUI();\r\n    }\r\n\r\n    /** 充值 */\r\n    private onChongZhi() {\r\n        UtilMgr.PlaySoundEffect(18);\r\n        PaymentMgr.OpenPaymentUI();\r\n    }\r\n\r\n    /** 任务 */\r\n    private onTask() {\r\n        UtilMgr.PlaySoundEffect(18);\r\n        TaskMgr.OpenTaskUI();\r\n    }\r\n\r\n    /** 采购 */\r\n    private onCaiGou() {\r\n        UtilMgr.PlaySoundEffect(21);\r\n        HeChengMgr.onCaiGou(false);\r\n    }\r\n\r\n    /** 自动 */\r\n    private onAuto() {\r\n        UtilMgr.PlaySoundEffect(18);\r\n        HeChengMgr.onAuto();\r\n    }\r\n\r\n    /** 拔萝卜 */\r\n    private onPullCarrots() {\r\n        UtilMgr.PlaySoundEffect(18);\r\n        HeChengMgr.onGotoCarrots();\r\n    }\r\n\r\n    /** 打开商店 */\r\n    private onShopOpen() {\r\n        UtilMgr.PlaySoundEffect(18);\r\n        oops.gui.open(UIID.ShopMain);\r\n    }\r\n\r\n    /** 打开加速界面 */\r\n    private onOpenAccelerate() {\r\n        UtilMgr.PlaySoundEffect(18);\r\n        oops.gui.open(UIID.AcceleratedBuffBuyMain);\r\n    }\r\n\r\n    /** 打开喂食界面 */\r\n    private onOpenFeedMain() {\r\n        UtilMgr.PlaySoundEffect(18);\r\n        oops.gui.open(UIID.FeedMain);\r\n    }\r\n\r\n    /** 打开邀请界面 */\r\n    private onOpenInviteMain() {\r\n        UtilMgr.PlaySoundEffect(18);\r\n        IniviteMgr.onOpenInviteMain();\r\n    }\r\n\r\n    /** 点击静音按钮 */\r\n    private onMuteBtnClick() {\r\n        UtilMgr.PlaySoundEffect(18);\r\n        TonGameMgr.IsMute = (!TonGameMgr.IsMute);\r\n        this.RefreshMuteBtn();\r\n        oops.audio.switchEffect = (!TonGameMgr.IsMute);\r\n        oops.audio.switchMusic = (!TonGameMgr.IsMute);\r\n        if (!TonGameMgr.IsMute) {\r\n            if (AcceleratedBuffMgr.isAccelerating()) {\r\n                UtilMgr.PlayBgMusic(23);\r\n            } else {\r\n                UtilMgr.PlayBgMusic(22);\r\n            }\r\n        }\r\n    }\r\n\r\n    createGrid() {\r\n        let gridUITransform = this.gridPrefab.data.getComponent(UITransform);\r\n        if (gridUITransform)\r\n        {\r\n            this.gridWidth = gridUITransform.width;\r\n            this.gridHeight = gridUITransform.height;\r\n        }\r\n        for (let row = 0; row < GAME_GRID_SIZE; row++) {\r\n            for (let col = 0; col < GAME_GRID_SIZE; col++) {\r\n                const grid = instantiate(this.gridPrefab);\r\n                grid.parent = this.gridParentNode;\r\n                grid.setPosition(startX + col * (this.gridWidth + gridSpacing), startY - row * (this.gridHeight + gridSpacing)); // 计算格子位置\r\n                const gridComponent = grid.getComponent(GridComponent);\r\n                if (gridComponent) \r\n                {\r\n                    gridComponent.setVisible(false);\r\n                }\r\n                this.board.push(grid);\r\n            }\r\n        }\r\n        this.updateGrid();\r\n    }\r\n\r\n    public getGridNode(index): Node {\r\n        if (index >= 0 && index < this.board.length)\r\n        {\r\n            return this.board[index];\r\n        }\r\n        return null;\r\n    }\r\n\r\n    updateGrid() {\r\n        for (let index = 0; index < this.board.length; index++) {\r\n            const cell = this.board[index];\r\n            if (BoardMgr.board && BoardMgr.board[index])\r\n            {\r\n                const gridComponent = cell.getComponent(GridComponent);\r\n                if (gridComponent) \r\n                {\r\n                    gridComponent.index = index;\r\n                    if (BoardMgr.board[index].SuCaiId > 0)\r\n                    {\r\n                        gridComponent.setVisible(true);\r\n                        gridComponent.setLiwuVisible(false);\r\n                        gridComponent.setLevel(TonGameMgr.GetSuCaiLevel(BoardMgr.board[index].SuCaiId));\r\n                    }\r\n                    else\r\n                    {\r\n                        gridComponent.setVisible(false);\r\n                        if (BoardMgr.board[index].IsLiWu && !BoardMgr.board[index].IsLiWuFlying)\r\n                        {\r\n                            gridComponent.setLiwuVisible(true);\r\n                        }\r\n                        else\r\n                        {\r\n                            gridComponent.setLiwuVisible(false);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    private onAutoHecheng(args: any) {\r\n        let SrcIndex = args.SrcIndex;\r\n        let DestIndex = args.DestIndex;\r\n        if (this.board && this.board[SrcIndex] && this.board[DestIndex])\r\n        {\r\n            const srcCell = this.board[SrcIndex];\r\n            const gridFlyComponent = srcCell.getComponentInChildren(FlyComponent);\r\n            if (gridFlyComponent) \r\n            {\r\n                console.log(\"Fly src=\" + SrcIndex + \" dest=\" + DestIndex);\r\n                BoardMgr.InDragIndex = SrcIndex;\r\n                let srcCol = Math.floor(SrcIndex % 4);\r\n                let destCol = Math.floor(DestIndex % 4);\r\n                let srcRow = Math.floor(SrcIndex / 4);\r\n                let destRow = Math.floor(DestIndex / 4);\r\n                let TargetX = (destCol - srcCol) * (this.gridWidth + gridSpacing);\r\n                let TargetY = (srcRow - destRow) * (this.gridHeight + gridSpacing);\r\n                gridFlyComponent.beginFly(SrcIndex, DestIndex, TargetX, TargetY);\r\n            }\r\n        }\r\n    }\r\n\r\n    public createRole() : Node {\r\n        const role = instantiate(this.rolePrefab);\r\n        role.parent = this.roleParentNode;\r\n        const halfRoleHeight = role.getComponent(UITransform).height / 2;\r\n        role.setPosition(50, -halfRoleHeight);\r\n\r\n        const roleComponent = role.getComponent(RoleComponent);\r\n        if (roleComponent) \r\n        {\r\n            roleComponent.Init();\r\n        }\r\n        return role;\r\n    }\r\n\r\n    createTable() {\r\n        let tableUITransform = this.tablePrefab.data.getComponent(UITransform);\r\n        if (tableUITransform)\r\n        {\r\n            this.tableWidth = tableUITransform.width;\r\n            this.tableHeight = tableUITransform.height;\r\n        }\r\n        for (let row = 0; row < 2; row++) {\r\n            for (let col = 0; col < 2; col++) {\r\n                const table = instantiate(this.tablePrefab);\r\n                table.parent = this.tableParentNode;\r\n                table.setPosition(tableStartX + col * (this.tableWidth + tableSpacing), tableStartY - row * (this.tableHeight)); // 计算格子位置\r\n                DiningTableMgr.AddTable(table);\r\n            }\r\n        }\r\n    }\r\n\r\n    public createLiwu() : Node {\r\n        const liwu = instantiate(this.liwuPrefab);\r\n        liwu.parent = this.liwuParentNode;\r\n        //liwu.setSiblingIndex(1);\r\n        return liwu;\r\n    }\r\n\r\n    public createTuziCoin(RoleNode:Node) {\r\n        for (let i = 0; i < this.tuziCoinCount; i++) {\r\n            // 实例化金币\r\n            const coin = instantiate(this.tuziCoinPrefab);\r\n            coin.parent = this.tuziCoinParentNode;\r\n\r\n            // 设置初始位置\r\n            coin.setPosition(RoleNode.getPosition());\r\n\r\n            // 添加一个随机偏移，使金币生成位置有一定范围\r\n            const offset = new Vec3(\r\n                (Math.random() - 0.5) * 100,\r\n                (Math.random() - 0.5) * 100,\r\n                0\r\n            );\r\n            const randomStartPosition = RoleNode.getPosition().add(offset);\r\n            coin.setPosition(randomStartPosition);\r\n\r\n            // 创建飞行动画\r\n            tween(coin)\r\n                .to(1.2, { position: this.getPositionInParent(coin) }, { easing: 'sineOut' })\r\n                .call(() => {\r\n                    // 到达目标位置后销毁金币\r\n                    coin.destroy();\r\n                })\r\n                .start();\r\n        }\r\n\r\n        setTimeout(() => {\r\n            UtilMgr.PlaySoundEffect(3);\r\n        }, 1000);\r\n    }\r\n\r\n    public getPositionInParent(CoinNode: Node): Vec3 {\r\n        let TuziCoinPos = this.TuZiCoinImage.node.getPosition();\r\n        const worldPos = this.TuZiCoinImage.node.parent.getComponent(UITransform).convertToWorldSpaceAR(TuziCoinPos);\r\n        return CoinNode.parent.getComponent(UITransform).convertToNodeSpaceAR(worldPos);\r\n    }\r\n\r\n    public ShowCanTingGainNum()\r\n    {\r\n        let originalScale = new Vec3(1, 1, 1);\r\n        let TempScale = new Vec3(1, 1, 1);\r\n        const scaleUp = TempScale.multiplyScalar(1.2); // 放大20%\r\n        // 使用 tween 动画实现放大和缩小效果\r\n        tween(this.CanTingGain.node)\r\n            .to(0.2, { scale: scaleUp })   // 放大到1.2倍，持续0.2秒\r\n            .to(0.2, { scale: originalScale }) // 缩小回原始比例，持续0.2秒\r\n            .start();\r\n    }\r\n\r\n    public createGuide() : Node {\r\n        const guide = instantiate(this.guidePrefab);\r\n        guide.parent = this.gridParentNode;\r\n        return guide;\r\n    }\r\n\r\n    public ShowSucaiSelect(isShow:boolean, curIndex:number) {\r\n        if (isShow)\r\n        {\r\n            let SuCaiId = BoardMgr.board[curIndex].SuCaiId;\r\n            if (SuCaiId > 0)\r\n            {\r\n                for (let index = 0; index < this.board.length; index++) {\r\n                    const cell = this.board[index];\r\n                    if (BoardMgr.board && BoardMgr.board[index] && curIndex != index && BoardMgr.board[index].SuCaiId == SuCaiId)\r\n                    {\r\n                        const gridComponent = cell.getComponent(GridComponent);\r\n                        if (gridComponent) \r\n                        {\r\n                            gridComponent.setSelectVisible(true);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        else\r\n        {\r\n            for (let index = 0; index < this.board.length; index++) {\r\n                const cell = this.board[index];\r\n                if (BoardMgr.board && BoardMgr.board[index])\r\n                {\r\n                    const gridComponent = cell.getComponent(GridComponent);\r\n                    if (gridComponent) \r\n                    {\r\n                        gridComponent.setSelectVisible(false);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\n"]}