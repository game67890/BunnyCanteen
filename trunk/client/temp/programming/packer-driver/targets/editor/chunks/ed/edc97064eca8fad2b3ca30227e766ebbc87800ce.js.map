{"version":3,"sources":["file:///F:/TON-Game/src/trunk/client/assets/scripts/tongame/feed/FeedItemCell.ts"],"names":["_decorator","Label","Sprite","Button","Widget","IVirtualGridListItem","TableIngredients","UtilMgr","FeedMgr","BoardMgr","oops","TonGameMgr","PaymentMgr","GameEvent","UIID","HeChengComponent","TableOtherParameter","FeedMain","TableRestaurantlevel","ccclass","property","FeedItemCell","tablerecord","lockstate","costtype","costnum","_tsRestaurantlevel","onSelect","updateSelectionStatus","onUnselect","onDataChanged","data","init","configid","CanTingLevel","FreeBtnTxt","string","language","getLangByID","SetImage","DishIcon","picture","DishLevel","level","toString","ShowTxt","EffectTxt","getmoney","maxlevel","HechengMaxLevel","type","foodlevel","LockWnd","node","active","TujianIcon","BuyBtn","FreeDishId","FreeBtn","addNodeAnimation","FreeEffect","CostCarrotIcon","CostRabbitIcon","cost2","cost1","ExtDishPrice","Number","Math","floor","PriceTxt","formatNumber","BigInt","onDestroy","onBuyBtnClick","PlaySoundEffect","isHasEmptyGrid","gui","toast","CarrotCoin","OpenPaymentUI","SendBuyDish","TuZiCoin","addGrid","updateRabbitCoin","message","dispatchEvent","UpdateTuziCoin","UpdateBaseData","UpdateBoardGrid","Save","UpdateExtDishPrice","FeedGUI","get","FeedCom","getComponent","updategridList","onFreeBtnClick","tablereward","NextFreeDishTime","parameter","HechengGUI","MainUI","HechengCom","RefreshFeedRed"],"mappings":"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","sourcesContent":["import {_decorator, Label, Sprite, Button, Widget} from 'cc';\r\nimport {IVirtualGridListItem} from \"../../../resources/libs/virtual_grid_list/interface\";\r\nimport { TableIngredients } from '../../framework/common/table/TableIngredients';\r\nimport { UtilMgr } from '../manager/UtilManager';\r\nimport { FeedMgr } from './FeedManager';\r\nimport { BoardMgr } from '../manager/BoardManager';\r\nimport { oops } from '../../../../extensions/oops-plugin-framework/assets/core/Oops';\r\nimport { TonGameMgr } from '../manager/TonGameManager';\r\nimport { PaymentMgr } from '../payment/PaymentManager';\r\nimport { GameEvent } from '../../framework/common/config/GameEvent';\r\nimport { UIID } from '../../framework/common/config/GameUIConfig';\r\nimport { HeChengComponent } from '../hecheng/HeChengComponent';\r\nimport { TableOtherParameter } from '../../framework/common/table/TableOtherParameter';\r\nimport { FeedMain } from './FeedMain';\r\nimport { TableRestaurantlevel } from '../../framework/common/table/TableRestaurantlevel';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('FeedItemCell')\r\nexport class FeedItemCell extends IVirtualGridListItem {\r\n    @property(Sprite)\r\n    DishIcon: Sprite;\r\n    @property(Label)\r\n    DishLevel: Label;\r\n    @property(Label)\r\n    ShowTxt: Label;\r\n    @property(Label)\r\n    EffectTxt: Label;\r\n    @property(Widget)\r\n    LockWnd: Widget;\r\n    @property(Sprite)\r\n    CostCarrotIcon: Sprite;\r\n    @property(Sprite)\r\n    CostRabbitIcon: Sprite;\r\n    @property(Label)\r\n    PriceTxt: Label;\r\n    @property(Button)\r\n    BuyBtn: Button;\r\n    @property(Button)\r\n    FreeBtn: Button;\r\n    @property(Label)\r\n    FreeBtnTxt: Label;\r\n    @property(Sprite)\r\n    FreeEffect: Sprite;\r\n    @property(Sprite)\r\n    TujianIcon: Sprite;\r\n\r\n    private tablerecord = new TableIngredients();\r\n    private lockstate : boolean = true;\r\n    private costtype : number = 0;\r\n    private costnum : number = 0;\r\n\r\n    private _tsRestaurantlevel = new TableRestaurantlevel();\r\n\r\n    /** 点击触发选择事件 */\r\n    onSelect() {\r\n        this.updateSelectionStatus();\r\n    }\r\n\r\n    onUnselect() {\r\n        this.updateSelectionStatus();\r\n    }\r\n\r\n    onDataChanged() {\r\n        const data = this.data;\r\n        this.tablerecord.init(data.configid);\r\n        this._tsRestaurantlevel.init(TonGameMgr.CanTingLevel);\r\n        if (!this.tablerecord) {\r\n            return;\r\n        }\r\n\r\n        this.FreeBtnTxt.string = oops.language.getLangByID(\"stringres_182\");\r\n\r\n        // 菜品造型图标\r\n        UtilMgr.SetImage(this.DishIcon, this.tablerecord.picture);\r\n        // 菜品等级\r\n        this.DishLevel.string = this.tablerecord.level.toString();\r\n\r\n        // 菜品收益\r\n        this.ShowTxt.string = oops.language.getLangByID(\"stringres_114\");\r\n        this.EffectTxt.string = \"+\" + this.tablerecord.getmoney.toString() + \"/s\";\r\n\r\n        let maxlevel = 1;\r\n        if (FeedMgr.HechengMaxLevel[this.tablerecord.type]) {\r\n            maxlevel = FeedMgr.HechengMaxLevel[this.tablerecord.type];\r\n        }\r\n\r\n        // 锁头图标\r\n        this.lockstate = (this.tablerecord.level > this._tsRestaurantlevel.foodlevel+2);\r\n        this.LockWnd.node.active = this.lockstate;\r\n        // 大拇指图标\r\n        this.TujianIcon.node.active = (this.tablerecord.level == this._tsRestaurantlevel.foodlevel + 2);\r\n\r\n        // 按钮显示\r\n        this.BuyBtn.node.active = (data.configid != FeedMgr.FreeDishId \r\n            && this.tablerecord.level <= this._tsRestaurantlevel.foodlevel + 2);\r\n        this.FreeBtn.node.active = (data.configid == FeedMgr.FreeDishId);\r\n        if (data.configid == FeedMgr.FreeDishId) {\r\n            UtilMgr.addNodeAnimation(\"animation/anniuda\", this.FreeEffect.node, true, true);\r\n        }\r\n\r\n        // 货币图标\r\n        this.CostCarrotIcon.node.active = (this.tablerecord.level == this._tsRestaurantlevel.foodlevel + 1\r\n            || this.tablerecord.level == this._tsRestaurantlevel.foodlevel + 2);\r\n        this.CostRabbitIcon.node.active = (this.tablerecord.level <= this._tsRestaurantlevel.foodlevel);\r\n\r\n        if (this.tablerecord.level == this._tsRestaurantlevel.foodlevel + 1\r\n            || this.tablerecord.level == this._tsRestaurantlevel.foodlevel + 2) {\r\n            this.costtype = 1;  // 消耗萝卜币\r\n            this.costnum = this.tablerecord.cost2;\r\n        }\r\n        else if (this.tablerecord.level <= this._tsRestaurantlevel.foodlevel) {\r\n            this.costtype = 2;  // 消耗兔子币\r\n            this.costnum = this.tablerecord.cost1;\r\n        }\r\n        // 价格\r\n        if (FeedMgr.ExtDishPrice[Number(this.data.configid)]) {\r\n            this.costnum = Math.floor(this.costnum*(1+FeedMgr.ExtDishPrice[Number(this.data.configid)]));\r\n        }\r\n        if (this.costtype == 2)\r\n        {\r\n            this.PriceTxt.string = UtilMgr.formatNumber(BigInt(this.costnum));\r\n        }\r\n        else\r\n        {\r\n            this.PriceTxt.string = this.costnum.toString();\r\n        }\r\n        \r\n        this.updateSelectionStatus();\r\n    }\r\n\r\n    updateSelectionStatus() {\r\n\r\n    }\r\n\r\n    onDestroy() {\r\n        super.onDestroy();\r\n    }\r\n\r\n    public onBuyBtnClick() {\r\n        UtilMgr.PlaySoundEffect(18);\r\n        if (this.lockstate) {\r\n            return;\r\n        }\r\n        if (!BoardMgr.isHasEmptyGrid())\r\n        {\r\n            oops.gui.toast(\"message_09\", true);     // 空位不足！\r\n            return;\r\n        }\r\n\r\n        let tablerecord = new TableIngredients();\r\n        tablerecord.init(this.data.configid);\r\n        if (this.costtype == 1) {\r\n            if (TonGameMgr.CarrotCoin < this.costnum) {\r\n                oops.gui.toast(\"message_13\", true);     // 萝卜币不足！\r\n                PaymentMgr.OpenPaymentUI();\r\n            }\r\n            else {\r\n                FeedMgr.SendBuyDish(this.data.configid, this.costnum);\r\n            }\r\n        }\r\n        else if (this.costtype == 2) {\r\n            if (TonGameMgr.TuZiCoin < this.costnum) {\r\n                oops.gui.toast(\"message_10\", true);     // 兔子币不足！\r\n            }\r\n            else {\r\n                if (BoardMgr.addGrid(this.data.configid))\r\n                {\r\n                    TonGameMgr.updateRabbitCoin(TonGameMgr.TuZiCoin-BigInt(this.costnum));\r\n                    oops.message.dispatchEvent(GameEvent.UpdateTuziCoin);\r\n                    oops.message.dispatchEvent(GameEvent.UpdateBaseData);\r\n                    oops.message.dispatchEvent(GameEvent.UpdateBoardGrid);\r\n                    oops.message.dispatchEvent(GameEvent.Save);\r\n                }\r\n\r\n                FeedMgr.UpdateExtDishPrice(Number(this.data.configid));\r\n                const FeedGUI = oops.gui.get(UIID.FeedMain);\r\n                if (FeedGUI) {\r\n                    const FeedCom = FeedGUI.getComponent(FeedMain);\r\n                    if (FeedCom) {\r\n                        FeedCom.updategridList();\r\n                    }\r\n                }\r\n                oops.gui.toast(\"message_11\", true);     // 购买成功！\r\n            }\r\n        }\r\n    }\r\n\r\n    public onFreeBtnClick() {\r\n        UtilMgr.PlaySoundEffect(18);\r\n        if (this.lockstate) {\r\n            return;\r\n        }\r\n        if (!BoardMgr.isHasEmptyGrid())\r\n        {\r\n            oops.gui.toast(\"message_09\", true);     // 空位不足！\r\n            return;\r\n        }\r\n\r\n        if (BoardMgr.addGrid(this.data.configid))\r\n        {\r\n            oops.message.dispatchEvent(GameEvent.UpdateBaseData);\r\n            oops.message.dispatchEvent(GameEvent.UpdateBoardGrid);\r\n            oops.message.dispatchEvent(GameEvent.Save);\r\n        }\r\n        let tablereward = new TableOtherParameter();\r\n        tablereward.init(3);\r\n        FeedMgr.NextFreeDishTime = Number(tablereward.parameter);\r\n        FeedMgr.FreeDishId = 0;\r\n\r\n        const HechengGUI = oops.gui.get(UIID.MainUI);\r\n        if (HechengGUI) {\r\n            const HechengCom = HechengGUI.getComponent(HeChengComponent);\r\n            if (HechengCom) {\r\n                HechengCom.RefreshFeedRed();\r\n            }\r\n        }\r\n        const FeedGUI = oops.gui.get(UIID.FeedMain);\r\n        if (FeedGUI) {\r\n            const FeedCom = FeedGUI.getComponent(FeedMain);\r\n            if (FeedCom) {\r\n                FeedCom.updategridList();\r\n            }\r\n        }\r\n\r\n        oops.gui.toast(\"message_11\", true);     // 购买成功！\r\n    }\r\n}\r\n"]}