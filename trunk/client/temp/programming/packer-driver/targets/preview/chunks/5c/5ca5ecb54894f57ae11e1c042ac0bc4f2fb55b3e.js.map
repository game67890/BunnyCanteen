{"version":3,"sources":["file:///F:/TON-Game/src/trunk/client/assets/scripts/tongame/pullingcarrots/CarrotRankComponent.ts"],"names":["RankDataItem","_decorator","Component","Label","Vec3","Button","Widget","Sprite","oops","UIID","GameEvent","TonGameMgr","CarrotMgr","VirtualGridList","UtilMgr","ccclass","property","_temp_vec3","rank","rolename","weight","userid","CarrotRankComponent","_dataList","onAdded","params","NextTimeWnd","node","active","NoRankTxt","string","language","getLangByID","RewardBtnTxt","TitleTxt","SetImage","HeadIcon","ShowUserHead","UserId","init","addEvent","rankitemlist","length","i","item","idx","name","userID","push","initGridList","gridList","clearList","paddingTop","paddingBottom","spacingX","spacingY","columnNum","useVirtualLayout","cacheImage","registerSelectOneItemEventHandler","_onSelectOneItem","appendItemsToDisplayList","data","console","log","start","updateTuziCoin","RefreshMyRankShow","CurrentCarrotRank","MyRankWnd","MyRank","toString","MyName","MyWeight","CurrentCarrotWeight","onDestroy","removeEvent","message","on","UpdateTuziCoin","onUpdateData","off","event","args","RabbitCoinNum","formatNumber","TuZiCoin","onCloseBtnClick","PlaySoundEffect","gui","remove","CarrotRank","onTipsBtnClick","open","CarrotTips","onRewardBtnClick","CarrotRankReward"],"mappings":"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","sourcesContent":["import { _decorator, Component, Node, Label, Prefab, instantiate, Vec3, UITransform } from 'cc';\r\nimport { oops } from \"../../../../extensions/oops-plugin-framework/assets/core/Oops\";\r\nimport { UIID } from \"../../framework/common/config/GameUIConfig\";\r\nimport { GameEvent } from \"../../framework/common/config/GameEvent\";\r\nimport { TonGameMgr } from \"../manager/TonGameManager\";\r\nimport { Button } from 'cc';\r\nimport { Widget } from 'cc';\r\nimport { CarrotMgr } from './CarrotManager';\r\nimport { VirtualGridList } from \"../../../resources/libs/virtual_grid_list/virtual_grid_list\";\r\nimport { UtilMgr } from '../manager/UtilManager';\r\nimport { Sprite } from 'cc';\r\nconst { ccclass, property } = _decorator;\r\n\r\nconst _temp_vec3 = new Vec3();\r\n\r\nclass RankDataItem {\r\n    rank: number = 0;\r\n    rolename: string = \"\";\r\n    weight: number = 0;\r\n    userid:number = 0;\r\n}\r\n\r\n@ccclass('CarrotRankComponent')\r\nexport class CarrotRankComponent extends Component {\r\n    @property(Button)\r\n    CloseBtn: Button;\r\n    @property(Button)\r\n    TipsBtn: Button;\r\n    @property(Label)\r\n    RabbitCoinNum: Label;\r\n    @property(Widget)\r\n    NextTimeWnd: Widget;\r\n    @property(Label)\r\n    NoRankTxt: Label;\r\n    @property(Widget)\r\n    MyRankWnd: Widget;\r\n    @property(Button)\r\n    RewardBtn: Button;\r\n    @property(Label)\r\n    RewardBtnTxt: Label;\r\n\r\n    @property(Label)\r\n    MyRank: Label;\r\n    @property(Label)\r\n    MyName: Label;\r\n    @property(Label)\r\n    MyWeight: Label;\r\n\r\n    @property(Label)\r\n    TitleTxt: Label;\r\n\r\n    @property(Sprite)\r\n    HeadIcon: Sprite;\r\n\r\n    @property(VirtualGridList)\r\n    protected gridList: VirtualGridList = null;\r\n\r\n    private _dataList: any[] = [];\r\n\r\n\r\n    onAdded(params: any): boolean {\r\n        this.NextTimeWnd.node.active = false\r\n        this.NoRankTxt.string = oops.language.getLangByID(\"stringres_021\");\r\n        this.RewardBtnTxt.string = oops.language.getLangByID(\"stringres_030\");\r\n        this.TitleTxt.string = oops.language.getLangByID(\"stringres_179\");\r\n\r\n        UtilMgr.SetImage(this.HeadIcon, \"textures/UI/main/main;touxiang\");\r\n        UtilMgr.ShowUserHead(TonGameMgr.UserId, this.HeadIcon);\r\n        \r\n        this.init();\r\n        this.addEvent();\r\n        this._dataList = [];\r\n        if (params && params.rankitemlist.length > 0) {\r\n            for (let i = 0; i < params.rankitemlist.length; i++) {\r\n                const item: RankDataItem = {\r\n                    rank: params.rankitemlist[i].idx,\r\n                    rolename: params.rankitemlist[i].name,\r\n                    weight: params.rankitemlist[i].weight,\r\n                    userid:params.rankitemlist[i].userID,\r\n                }\r\n                this._dataList.push(item);\r\n            }\r\n            this.initGridList();\r\n        }\r\n        \r\n        return true;\r\n    }\r\n    initGridList() {\r\n        /*  paddingTop: 列表距离上边缘距离 默认为0\r\n        paddingBottom: 列表距离下边缘距离 默认为0\r\n        spacingX: 列间距 默认为3\r\n        spacingY: 行间距 默认为3\r\n        columnNum: 列数 默认为0，自动适配容器宽度\r\n        useVirtualLayout: 是否启用虚拟列表 默认为true\r\n        emptyTip: 没有数据显示提示\r\n        cacheImage: 是否缓存列表中加载过的图片，控件回收后，图片缓存将被全部释放。\r\n     */\r\n        if (this.gridList) {\r\n            this.gridList.clearList();\r\n            this.gridList.initGridList({\r\n                paddingTop: 0,\r\n                paddingBottom: 10,\r\n                spacingX: 10,\r\n                spacingY: 0,\r\n                columnNum: 1,\r\n                useVirtualLayout: true,\r\n                // emptyTip: oops.language.getLangByID(\"stringres_088\"),\r\n                cacheImage: true\r\n            });\r\n            //this.gridList.registerScrollToBottomEventHandler(this._nextPage, this);\r\n            this.gridList.registerSelectOneItemEventHandler(this._onSelectOneItem, this);\r\n\r\n            this.gridList.appendItemsToDisplayList(this._dataList);\r\n        }\r\n    }\r\n\r\n    _onSelectOneItem(data: any) {\r\n        console.log('_onSelectOneItem');\r\n    }\r\n\r\n    start() {\r\n\r\n    }\r\n\r\n    private init() {\r\n        this.updateTuziCoin();\r\n        this.RefreshMyRankShow();\r\n    }\r\n\r\n    private RefreshMyRankShow() {\r\n        this.NoRankTxt.node.active = (CarrotMgr.CurrentCarrotRank <= 0)\r\n        this.MyRankWnd.node.active = (CarrotMgr.CurrentCarrotRank > 0)\r\n        if (CarrotMgr.CurrentCarrotRank > 0) {\r\n            this.MyRank.string = CarrotMgr.CurrentCarrotRank.toString();\r\n            this.MyName.string = \"\";\r\n            this.MyWeight.string = CarrotMgr.CurrentCarrotWeight.toString()+\"kg\";\r\n        }\r\n    }\r\n\r\n    onDestroy() {\r\n        this.removeEvent();\r\n    }\r\n\r\n    /** 添加全局消息事件 */\r\n    private addEvent() {\r\n        oops.message.on(GameEvent.UpdateTuziCoin, this.onUpdateData, this);\r\n    }\r\n\r\n    /** 移除全局消息事件 */\r\n    private removeEvent() {\r\n        oops.message.off(GameEvent.UpdateTuziCoin, this.onUpdateData, this);\r\n    }\r\n\r\n    private onUpdateData(event: string, args: any) {\r\n        switch (event) {\r\n            case GameEvent.UpdateTuziCoin:\r\n                this.updateTuziCoin();\r\n                break;\r\n        }\r\n    }\r\n\r\n    private updateTuziCoin() {\r\n        this.RabbitCoinNum.string = UtilMgr.formatNumber(TonGameMgr.TuZiCoin);\r\n    }\r\n\r\n    // 点击关闭按钮\r\n    public onCloseBtnClick() {\r\n        UtilMgr.PlaySoundEffect(19);\r\n        oops.gui.remove(UIID.CarrotRank);\r\n    }\r\n\r\n    // 点击tips按钮\r\n    public onTipsBtnClick() {\r\n        UtilMgr.PlaySoundEffect(18);\r\n        oops.gui.open(UIID.CarrotTips, 2);\r\n    }\r\n\r\n    // 点击报酬按钮\r\n    public onRewardBtnClick() {\r\n        UtilMgr.PlaySoundEffect(18);\r\n        oops.gui.open(UIID.CarrotRankReward);\r\n    }\r\n}\r\n\r\n\r\n"]}