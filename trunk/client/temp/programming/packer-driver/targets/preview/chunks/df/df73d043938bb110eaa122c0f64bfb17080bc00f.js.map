{"version":3,"sources":["file:///F:/TON-Game/src/trunk/client/assets/scripts/tongame/task/AchievementListItem.ts"],"names":["_decorator","Label","Sprite","IVirtualGridListItem","TaskMgr","AchievementItemVirtualGridList","oops","UtilMgr","TonGameMgr","ccclass","property","AchievementListItem","_achievementItemDataList","ShowAchievementItemList","AchievementType","AchievementCellList","GetAchievementItemCellList","id","AchievementData","ServerData","JSON","parse","ServerAchievementList","isFinished","progress","push","initAchievementItemGridList","achievementItemGridList","clearList","initGridList","paddingTop","paddingBottom","spacingX","spacingY","columnNum","useVirtualLayout","emptyTip","cacheImage","appendItemsToDisplayList","updateItem","data","itemIndex","_itemIndex","_data","SetImage","achievementIcon","achieveicon","achievementName","string","language","getLangByID","achievename","achievementTips","achievetips","achievetype","jinduCoin","node","active","jinduCoinImage","jindu","GetRealCanTingGain","toString","onDestroy"],"mappings":"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","sourcesContent":["import {_decorator, Label, Sprite, math, SpriteFrame, Node} from 'cc';\r\nimport {IVirtualGridListItem} from \"../../../resources/libs/virtual_grid_list/interface\";\r\nimport { TaskMgr } from \"./TaskManager\";\r\nimport { AchievementItemVirtualGridList } from \"./AchievementItemVirtualGridList\";\r\nimport { oops } from \"../../../../extensions/oops-plugin-framework/assets/core/Oops\";\r\nimport { UtilMgr } from \"../manager/UtilManager\";\r\nimport { TonGameMgr } from '../manager/TonGameManager';\r\n\r\nconst {ccclass, property} = _decorator;\r\n\r\n@ccclass('AchievementListItem')\r\nexport class AchievementListItem extends IVirtualGridListItem {\r\n    @property(Sprite)\r\n    achievementIcon: Sprite = null;\r\n\r\n    @property(Label)\r\n    achievementName: Label = null;\r\n\r\n    @property(Label)\r\n    achievementTips: Label = null;\r\n\r\n    @property(Label)\r\n    jindu: Label = null;\r\n\r\n    @property(Label)\r\n    jinduCoin: Label = null;\r\n    @property(Sprite)\r\n    jinduCoinImage: Sprite = null;\r\n\r\n    @property(AchievementItemVirtualGridList)\r\n    protected achievementItemGridList: AchievementItemVirtualGridList = null;\r\n\r\n    private _achievementItemDataList: any[] = [];\r\n\r\n    private ShowAchievementItemList(AchievementType: number) {\r\n        let AchievementCellList = TaskMgr.GetAchievementItemCellList(AchievementType);\r\n        for (const id in AchievementCellList) {\r\n            let AchievementData = AchievementCellList[id];\r\n            let ServerData = JSON.parse(TaskMgr.ServerAchievementList[AchievementData.id]);\r\n            AchievementData.isFinished = ServerData.isFinished;\r\n            AchievementData.progress = ServerData.progress;\r\n            this._achievementItemDataList.push(AchievementData);\r\n        }\r\n\r\n        this.initAchievementItemGridList();\r\n    }\r\n\r\n    initAchievementItemGridList() {\r\n        /*  paddingTop: 列表距离上边缘距离 默认为0\r\n        paddingBottom: 列表距离下边缘距离 默认为0\r\n        spacingX: 列间距 默认为3\r\n        spacingY: 行间距 默认为3\r\n        columnNum: 列数 默认为0，自动适配容器宽度\r\n        useVirtualLayout: 是否启用虚拟列表 默认为true\r\n        emptyTip: 没有数据显示提示\r\n        cacheImage: 是否缓存列表中加载过的图片，控件回收后，图片缓存将被全部释放。\r\n     */\r\n        if (this.achievementItemGridList) {\r\n            this.achievementItemGridList.clearList();\r\n            this.achievementItemGridList.initGridList({\r\n                paddingTop: 10,\r\n                paddingBottom: 10,\r\n                spacingX: 10,\r\n                spacingY: 5,\r\n                columnNum: 1,\r\n                useVirtualLayout: true,\r\n                emptyTip: '',\r\n                cacheImage: true\r\n            });\r\n\r\n            this.achievementItemGridList.appendItemsToDisplayList(this._achievementItemDataList);\r\n        }\r\n    }\r\n\r\n    public updateItem(data: any, itemIndex: number): void {\r\n        this._itemIndex = itemIndex;\r\n        this._data = data;\r\n\r\n        UtilMgr.SetImage(this.achievementIcon, data.achieveicon);\r\n        this.achievementName.string = oops.language.getLangByID(this._data.achievename);\r\n        this.achievementTips.string = oops.language.getLangByID(this._data.achievetips);\r\n        let progress = this.data.progress;\r\n        if (this._data.achievetype == 4)\r\n        {//兔子币\r\n            this.jinduCoin.node.active = true;\r\n            this.jinduCoinImage.node.active = true;\r\n            UtilMgr.SetImage(this.jinduCoinImage, \"textures/UI/main/main;tuzibi\");\r\n            this.jindu.node.active = false;\r\n            progress = TonGameMgr.GetRealCanTingGain();\r\n        }\r\n        else if (this._data.achievetype == 5)\r\n        {//萝卜币\r\n            this.jinduCoin.node.active = true;\r\n            this.jinduCoinImage.node.active = true;\r\n            UtilMgr.SetImage(this.jinduCoinImage, \"textures/UI/main/main;luobobi\");\r\n            this.jindu.node.active = false;\r\n        }\r\n        else\r\n        {\r\n            this.jinduCoin.node.active = false;\r\n            this.jinduCoinImage.node.active = false;\r\n            this.jindu.node.active = true;\r\n        }\r\n        this.jindu.string = progress.toString();\r\n        this.jinduCoin.string = progress.toString();\r\n\r\n        this.achievementItemGridList.clearList();\r\n        this.ShowAchievementItemList(this._data.achievetype);\r\n    }\r\n\r\n    onDestroy() {\r\n        super.onDestroy();\r\n    }\r\n}\r\n"]}