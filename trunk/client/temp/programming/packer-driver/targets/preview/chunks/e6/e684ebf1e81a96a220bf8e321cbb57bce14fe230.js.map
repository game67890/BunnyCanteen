{"version":3,"sources":["file:///F:/TON-Game/src/trunk/client/assets/scripts/tongame/pullingcarrots/CarrotRewardComponent.ts"],"names":["_decorator","Component","Label","Button","oops","UIID","CarrotComponent","StringUtil","CarrotMgr","TableRadishAwardWeight","TableOtherParameter","UtilMgr","ccclass","property","CarrotRewardComponent","CarrotRecord","updateTime","start","update","deltaTime","LeftTimes","CarrotRewardList","length","onCloseBtnClick","onAdded","params","TitleTxt","string","language","getLangByID","SureBtnTxt","ShowRewardInfo","PlaySoundEffect","tablerecord","init","Number","parameter","List","i","config","ShowTxt","substitute_1","speed","toString","time","radishname","radishweight","push","gui","remove","CarrotReward","CarrotMainUI","get","CarrotMain","CarrotMainCom","getComponent","StartPulling"],"mappings":"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","sourcesContent":["import { _decorator, Component, Label } from 'cc';\r\nimport { oops } from \"../../../../extensions/oops-plugin-framework/assets/core/Oops\";\r\nimport { UIID } from \"../../framework/common/config/GameUIConfig\";\r\nimport { Button } from 'cc';\r\nimport { CarrotComponent } from './CarrotComponent';\r\nimport { StringUtil } from \"../../../../extensions/oops-plugin-framework/assets/core/utils/StringUtil\";\r\nimport { CarrotMgr } from './CarrotManager';\r\nimport { TableRadishAwardWeight } from '../../framework/common/table/TableRadishAwardWeight';\r\nimport { TableOtherParameter } from '../../framework/common/table/TableOtherParameter';\r\nimport { UtilMgr } from '../manager/UtilManager';\r\n\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('CarrotRewardComponent')\r\nexport class CarrotRewardComponent extends Component {\r\n    @property(Button)\r\n    CloseBtn: Button;\r\n    @property(Label)\r\n    TitleTxt: Label;\r\n    @property(Label)\r\n    ShowTxt: Label;\r\n    @property(Button)\r\n    SureBtn: Button;\r\n    @property(Label)\r\n    SureBtnTxt: Label;\r\n\r\n    private CarrotRecord = new TableRadishAwardWeight();\r\n    private updateTime = 0;\r\n\r\n    start() {\r\n\r\n    }\r\n        \r\n    update(deltaTime: number) {\r\n        if (this.updateTime > 0) {\r\n            this.updateTime = this.updateTime - deltaTime\r\n            if (this.updateTime <= 0) {\r\n                this.updateTime == 0\r\n                if (CarrotMgr.LeftTimes > 0 || CarrotMgr.CarrotRewardList.length > 0) {\r\n                    this.onCloseBtnClick();\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    onAdded(params: any): boolean {\r\n        this.TitleTxt.string = oops.language.getLangByID(\"stringres_031\");\r\n        this.SureBtnTxt.string = oops.language.getLangByID(\"stringres_175\");\r\n        this.ShowRewardInfo();\r\n        return true;\r\n    }\r\n\r\n    public ShowRewardInfo() {\r\n        UtilMgr.PlaySoundEffect(2);\r\n        let tablerecord = new TableOtherParameter()\r\n        tablerecord.init(2);\r\n        this.updateTime = Number(tablerecord.parameter);\r\n\r\n        let List: any[] = [];\r\n        for (let i=0; i<CarrotMgr.CarrotRewardList.length; i++) {\r\n            if (i == 0) {\r\n                this.CarrotRecord.init(Number(CarrotMgr.CarrotRewardList[i].config))\r\n                this.ShowTxt.string = StringUtil.substitute_1(oops.language.getLangByID(\"stringres_033\"),CarrotMgr.CarrotRewardList[i].speed.toString()+\"/s\", CarrotMgr.CarrotRewardList[i].time) + \"\\n\"\r\n                                + StringUtil.substitute_1(oops.language.getLangByID(\"stringres_034\"), oops.language.getLangByID(this.CarrotRecord.radishname), this.CarrotRecord.radishweight.toString()+\"kg\") + \"\\n\";\r\n            }\r\n            else\r\n            {\r\n                List.push(CarrotMgr.CarrotRewardList[i]);\r\n            }\r\n        }\r\n        CarrotMgr.CarrotRewardList = List;\r\n    }\r\n\r\n    // 点击关闭按钮\r\n    public onCloseBtnClick() {\r\n        UtilMgr.PlaySoundEffect(18);\r\n        if (CarrotMgr.CarrotRewardList.length > 0)\r\n        {\r\n            this.ShowRewardInfo();\r\n            return;\r\n        }\r\n        oops.gui.remove(UIID.CarrotReward);\r\n\r\n        const CarrotMainUI = oops.gui.get(UIID.CarrotMain);\r\n        if (CarrotMainUI) {\r\n            const CarrotMainCom = CarrotMainUI.getComponent(CarrotComponent);\r\n            if (CarrotMainCom) {\r\n                CarrotMainCom.StartPulling();\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\n"]}